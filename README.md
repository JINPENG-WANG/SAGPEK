如有使用问题，请联系负责人： 王金鹏，博士，副研究员 wangjinpeng0225@163.com

山东省农业科学院畜牧兽医研究所

研究方向：奶牛基因组选择，重要经济性状关键基因挖掘



# SAGPEK
  Software packages for Sanger sequencing have shown little progress over time, although it is still widely used in human genetic disease diagnosis and livestock animal breeding. Determining the genotypes of tens to hundreds of sites in hundreds to thousands of samples simultaneously in Sanger sequencing data by manual visual conformation with traditional software is still time-consuming and error-prone. Here we present SAGPEK, which automatically identifies genotypes of target loci from hundreds to thousands of ABI-format Sanger sequencing data and directly reports genotypes to the output file. 
  SAGPEK is suitable for human genetic disease screening, drug-resistant mutation identification, livestock animal functional mutation detection, and other similar situations.

# Installation
Before using, users should install an Perl interpreter, such as from the ActiveState website (https://www.activestate.com/products/perl/). After the installation, the directories in which executable programs are located should be added to the PATH environment variable. Before running the package, users should put the ABI-format files generated by Sanger sequencing technology into the "ABI" file folder of the SAGPEK package. Then, the command prompt window is opened, and the working directory is changed to the SAGPEK package directory with the "cd" command. The program is run with the "perl SAGPEK.pl -type [TYPE]" command, where the TYPE should be replaced with HBV, PAH, cattle_CN, cattle_DUMPS, TEST, or custom according to the actual situation. If the "custom" type is used, users should also provide the name of a file storing the customized anchoring sequences located in the "Custom" directory and add the file name to the command as "perl SAGPEK.pl -type custom -tag ab.tags.txt ". The tag file must consists of two columns. The first column stores the names of the anchoring sequences, and the second column stores the sequences. After completion, a result file consisting of genotypes or amino acid alterations is generated in the Genotype Directory.  Users can also generate chromatograms for each input ABI file with the “perl SAGPEK.pl -type TEST -chromatogram on” command.

# SAGPEK Usage Overview
SAGPEK is a cross-platform Perl-based tool for automated genotype calling from Sanger sequencing data. This quick guide summarizes common usage scenarios, with grouped example commands, input requirements, and expected outputs.

## 1. Test Run (verify installation)
**Example command:**<br>
  `perl SAGPEK.pl -type TEST`<br><br> 
**Goal:** Confirm SAGPEK is installed and working.<br><br>
**Required input:** none<br><br>
**Optional input:** none<br><br>
**Output:** Information below will be printed to screen, confirming successful installation.<br>
  *Parameter Information:*<br>
  *The Orientation of Sanger sequencing is: f!*<br>
  *The 'r' is for Reverse and 'f' for Forward!*<br>
  *-----------------------------------------------------------*<br>
  *Processing 221224_0001.3401.F_A01!*<br>
  *Step 1: Extracting signals from ABI-format files......Done!*<br>
  *Step 2: Performing genotyping......Done!*<br>
  .........*<br><br>
  This command with generate a genotype table file (TEST.genotype.txt) in the *Genotype* directory with the following content:<br>
  | SampleID                        | First_Site_Genotype | Second_Site_Genotype | Third_Site_Genotype |
|---------------------------------|---------------------|----------------------|---------------------|
| testdata/221224_0001.3401.F_A01 | CCT,CAT             | CTT                  | ATG                 |
| testdata/221224_0002.3402.F_A02 | CCT,CAT             | CTT                  | CTG,ATG             |
| testdata/221224_0003.3403.F_A03 | CCT,CAT             | CTT                  | ATG                 |
| testdata/221224_0004.3404.F_A04 | CAT,CCT             | CTT                  | ATG,CTG             |
| testdata/221224_0005.3405.F_A05 | CAT,CCT             | CTT                  | ATG                 |
| testdata/221224_0006.3406.F_A06 | CAT,CCT             | CTT                  | ATG                 |
| testdata/221224_0007.3407.F_A07 | CAT,CCT             | CTT                  | ATG                 |
| testdata/221224_0008.3408.F_A08 | CAT,CCT             | CTT                  | ATG                 |
| testdata/221224_0009.3409.F_A09 | CCT,CAT             | CTT                  | ATG                 |
| testdata/221224_0010.3410.F_A10 | CAT,CCT             | CTT                  | ATG                 |


## 2. Base Calling & Genotyping<br>
**Example Command:**<br>
`perl SAGPEK.pl -type  custom -tag ab.tags.txt -orientation f -AA off`<br><br>
**Goal:** Call genotypes from chromatogram files.<br><br>
**Required inputs:**<br>
    (1)ABI files (*.ab1)<br> 
    (2)Tag file with target loci (ab.tags.txt)<br><br>
**Optinal inputs:**<br>
    (1)-orientaion f/r(Forward or Reverse; default = f)<br>
    (2)-AA on/off (report amino acid alterations; default = off)<br><br>
**Output:**<br>
    (1)Genotype table (.genotype.txt) listing homozygous/heterozygous calls at target loci<br>
    (2)Optional amino acid alteration information in the .genotype.txt file if -AA one<br><br>


## 3. Chromatogram Visualization<br>
**Example Command:**<br>
`perl SAGPEK.pl -type custom -tag ab.tags.txt -AA on -chromatogram on`<br><br>
**Goal:** Generate chromatogram images for visual inspection.<br><br>
**Required inputs:**<br>
(1)ABI files (*.ab1)<br>
(2)Tag file (ab.tags.txt)<br><br>
**Optional inputs:**<br>
(1)-chromatogram on (output chromatogram images as PNG)<br>
(2)-AA on (also report amino acid changes)<br><br>
**Output:**<br>
(1)Genotype table (.genotype.txt)<br>
(2)Chromatogram image files (.png) (example below):<br>
![SAGPEK chromatogram](https://github.com/JINPENG-WANG/SAGPEK/blob/main/chromatogram/test/221224_0001.3401.F_A01.chromatogram.png)





# Usage Examples
We list a set of common uses of SAGPEK below. We provide several ABI format files in the ABI folder as test dataset, which can be used to test SAGPEK.
The SAGPEK can be used in Windows/Linux/Mac systems as follows:

$  perl SAGPEK.pl -type TEST

This will generate a test output file (TEST.genotype.txt) in the ./SAGPEK/Genotype/ directory, allowing users to verify correct installation and execution.
If the -AA is set to off, the SAGPEK can be run as follows:

$  perl SAGPEK.pl -type TEST -AA off

This will generate a test output file which only reports the genotypes of tested loci but not the amino acids alterations.
Users can also test SAGPEK with the custom type. We have provided an tag file named "ab.tags.txt" in the Custom folder which stores anchoring sequences and their names. Users can run SAGPEK with the following command: 

$  perl SAGPEK.pl -type custom -tag ab.tags.txt 

This will generate an output file (Custom.mutants.txt) in the ./SAGPEK/Genotype/ directory, which stores genotypes of loci mapped with the anchoring sequencings in the “ab.tags.txt” file.
For the HBV, PAH, cattle_CN, and cattle_DUMPS types, SAGPEK has built-in anchoring sequences.
If chromatogram is needed, the SAGPEK can be run with the following command:

$ perl SAGPEK.pl -type custom -tag ab.tags.txt -chromatogram on

This will generate the chromatogram plots in the chromatogram directory for all investigated input ABI files.

For the TEST, HBV, PAH, cattle_CN, and cattle_DUMPS types, SAGPEK has built-in anchoring sequences. For the custom type, anchoring sequences will be obtained from the "ab.tags.txt" file, which SAGPEK provided as an example file under the "Custom" folder.
